(window["webpackJsonpvk-hack"]=window["webpackJsonpvk-hack"]||[]).push([[0],{193:function(e,t,n){e.exports=n(292)},284:function(e,t,n){},292:function(e,t,n){"use strict";n.r(t);n(194),n(220),n(222),n(223),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262);var a=n(0),s=n.n(a),r=n(76),i=n.n(r),o=n(48),c=n.n(o),l=n(77),u=n.n(l),h=n(106),d=n(26),p=n(27),m=n(29),g=n(28),f=n(18),v=n(30),E=n(116),b=n.n(E),w=n(115),k=n.n(w),y=(n(271),n(49)),j=n.n(y),O=n(45),x=n.n(O),I=n(52),C=n.n(I),U=n(22),S=n.n(U),_=n(46),q=n.n(_),A=n(53),P=n.n(A),T=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).state={activePanel:"home",fetchedUser:null,authToken:null,test:[]},n}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props)}},{key:"render",value:function(){var e=this.props.id;return s.a.createElement(j.a,{id:e},s.a.createElement(x.a,null,"\u041f\u0440\u043e\u0439\u0434\u0438 \u0442\u0435\u0441\u0442"),s.a.createElement(C.a,null,s.a.createElement(S.a,null,s.a.createElement("h1",null,this.props.test.name),s.a.createElement(q.a,{style:{margin:"12px 0"}}),s.a.createElement("p",{style:{lineHeight:"1.5"}},this.props.test.desc),s.a.createElement("img",{src:"https://demo18.alpha.vkhackathon.com/storage/"+this.props.test.img,style:{width:"100%"},alt:""}),s.a.createElement(S.a,null,s.a.createElement(P.a,{size:"xl",level:"secondary",onClick:this.props.go,"data-to":"quiz"},"\u041d\u0430\u0447\u0430\u0442\u044c \u0442\u0435\u0441\u0442!")))))}}]),t}(s.a.Component),Q=n(78),D=n(54),H=n(110),L=n.n(H),R=n(107),z=n.n(R),F=n(108),V=n.n(F),J=(n(284),n(113)),M=n.n(J),K=n(114),N=n.n(K),W=n(111),G=n.n(W),X=n(112),Z=n.n(X),B=n(109),Y=n.n(B),$=Object(D.c)(),ee=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).state={activePanel:"home",fetchedUser:null,authToken:null,items:[],currentQuestion:{},answers:[],questionCount:10,questionIndex:0,selectedAnswerId:null,answerIds:[]},n.nextQuestion=n.nextQuestion.bind(Object(f.a)(n)),n.onAnswerChanged=n.onAnswerChanged.bind(Object(f.a)(n)),n.showCongrats=n.showCongrats.bind(Object(f.a)(n)),n}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.questions.find((function(e){return!0===e.is_first}));this.setState({currentQuestion:e,answers:e.answers,questionIndex:0,selectedAnswerId:e.answers[0].id})}},{key:"showCongrats",value:function(){this.sendResults()}},{key:"nextQuestion",value:function(){var e=this,t=this.state.answers.find((function(t){return t.id===e.state.selectedAnswerId}));if(this.setState({answerIds:[].concat(Object(Q.a)(this.state.answerIds),[t.id])}),null===t.next_question_id)this.setState({isFinish:!0});else{var n=this.props.questions.find((function(e){return e.id===t.next_question_id}));this.setState({currentQuestion:n,answers:n.answers,questionIndex:this.state.questionIndex+1,selectedAnswerId:n.answers[0].id})}}},{key:"sendResults",value:function(){var e=this,t={external_id:this.props.fetchedUser.id,answers:this.state.answerIds};this.setState({answerIds:[].concat(Object(Q.a)(this.state.answerIds),[this.state.selectedAnswerId])}),fetch("https://demo18.alpha.vkhackathon.com/answer",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){return e.props.go("congrats",t)})),console.log(t)}},{key:"onAnswerChanged",value:function(e){var t=Number(e.currentTarget.value);null===this.state.answers.find((function(e){return e.id===t})).next_question_id&&this.setState({isFinish:!0}),this.setState({selectedAnswerId:t})}},{key:"render",value:function(){var e=this,t=this.props.id,n=this.state,a=n.currentQuestion,r=n.questionIndex,i=n.answers;return s.a.createElement(j.a,{id:t},s.a.createElement(x.a,{left:s.a.createElement(L.a,{onClick:this.props.go,"data-to":"home"},$===D.a?s.a.createElement(z.a,null):s.a.createElement(V.a,null))},"Persik"),s.a.createElement(S.a,null,s.a.createElement("h1",null,"\u0412\u043e\u043f\u0440\u043e\u0441 \u2116",r+1),s.a.createElement(q.a,{style:{margin:"12px 0"}}),s.a.createElement("p",{style:{lineHeight:"1.5"}},a.text),s.a.createElement(G.a,{title:this.props.id},s.a.createElement(Z.a,{value:this.state.questionIndex/this.props.questions.length*100})),s.a.createElement(q.a,{style:{margin:"12px 0"}}),s.a.createElement("img",{src:"https://demo18.alpha.vkhackathon.com/storage/"+a.img,style:{width:"100%"},alt:""}),s.a.createElement(M.a,null,s.a.createElement("div",null,i.length>0&&i.map((function(t,n){return s.a.createElement(N.a,{name:"answer",key:n,value:t.id,checked:e.state.selectedAnswerId===t.id,onChange:e.onAnswerChanged},t.text)})))),s.a.createElement("br",null),this.state.isFinish?s.a.createElement(P.a,{size:"xl",level:"commerce",onClick:this.showCongrats,"data-to":"congrats"},"\u0423\u0437\u043d\u0430\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b!"):s.a.createElement(P.a,{before:s.a.createElement(Y.a,null),level:"secondary",onClick:this.nextQuestion,size:"xl"},"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0432\u043e\u043f\u0440\u043e\u0441")))}}]),t}(s.a.Component),te=n(61),ne=n.n(te),ae=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).state={activePanel:"congrats",fetchedUser:null,authToken:null,result:{products:{id:1,name:"\u0412\u0430\u043c \u043f\u043e\u0432\u0435\u0437\u043b\u043e! \u0421\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0432\u0430\u0441 \u0443 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u044b\u0439 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u0438\u0439 \u043f\u0440\u043e\u0434\u0443\u043a\u0442",desc:"\u041f\u0440\u043e\u043c\u0441\u0432\u044f\u0437\u044c \u0431\u0430\u043d\u043a",url:"\u0441\u0441\u044b\u043b\u043a\u0430",img:"Fng2SH6fP7uZ87CQRHv1t9H8EXyRV15c602QnLlo.jpeg",pivot:{answer_id:1,product_id:1}},result:{id:2,text:"\u0425\u043c..\u041f\u043e\u0445\u043e\u0436\u0435 \u0442\u044b \u043b\u043e\u0445",img:"Fng2SH6fP7uZ87CQRHv1t9H8EXyRV15c602QnLlo.jpeg",test_id:1}}},n}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props)}},{key:"render",value:function(){var e=this.props.id;return s.a.createElement(j.a,{id:e},s.a.createElement(x.a,null,"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442"),s.a.createElement(C.a,null,s.a.createElement(S.a,null,s.a.createElement("h1",null,this.props.congr.message.result.text),s.a.createElement(q.a,{style:{margin:"12px 0"}}),s.a.createElement("img",{src:"https://demo18.alpha.vkhackathon.com/storage/"+this.props.congr.message.result.img,style:{width:"100%"},alt:""}))),s.a.createElement(C.a,null,s.a.createElement(S.a,null,s.a.createElement("h1",null,this.props.congr.message.products.name),s.a.createElement("p",null,this.props.congr.message.products.desc),s.a.createElement("img",{src:"https://demo18.alpha.vkhackathon.com/storage/"+this.props.congr.message.products.img,style:{width:"100%"},alt:""}),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement(S.a,{style:{textAlign:"center"}},s.a.createElement(D.b,{href:this.props.congr.message.products.url,target:"_blank"},"\u0423\u0436\u0435 \u0431\u0435\u0433\u0443 \u043e\u0444\u043e\u0440\u043c\u043b\u044f\u0442\u044c! \ud83e\udd84")))))}}]),t}(s.a.Component),se=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).go=function(e,t){if(t)return n.setState({congr:t}),void n.setState({activePanel:e});n.setState({activePanel:e.currentTarget.dataset.to})},n.state={fetchedUser:null,popout:s.a.createElement(k.a,{size:"large"}),activePanel:"home",test:{},isLoaded:!1,congr:null},n.getTest=n.getTest.bind(Object(f.a)(n)),n.sendUserData=n.sendUserData.bind(Object(f.a)(n)),n.go=n.go.bind(Object(f.a)(n)),n}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;c.a.subscribe((function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({fetchedUser:t.detail.data}),e.sendUserData();break;default:console.log(t.detail.type)}})),c.a.send("VKWebAppGetUserInfo",{}),this.getTest(),this.setState({popout:null})}},{key:"sendUserData",value:function(){var e={external_id:this.state.fetchedUser.id,first_name:this.state.fetchedUser.last_name,last_name:this.state.fetchedUser.first_name,photo:this.state.fetchedUser.photo_100||null};fetch("https://demo18.alpha.vkhackathon.com/client",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),console.log(e)}},{key:"getTest",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("https://demo18.alpha.vkhackathon.com/test/2").then((function(e){return e.json()})).then((function(e){t.setState({test:e,isLoaded:!0})}),(function(e){t.setState({isLoaded:!0,error:e})}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement(b.a,{activePanel:this.state.activePanel,popout:this.state.popout},this.state.isLoaded?s.a.createElement(T,{id:"home",fetchedUser:this.state.fetchedUser,test:this.state.test,go:this.go}):s.a.createElement(ne.a,null),this.state.isLoaded?s.a.createElement(ee,{id:"quiz",go:this.go,fetchedUser:this.state.fetchedUser,questions:this.state.test.questions}):s.a.createElement(ne.a,null),this.state.isLoaded?s.a.createElement(ae,{id:"congrats",go:this.go,congr:this.state.congr,fetchedUser:this.state.fetchedUser}):s.a.createElement(ne.a,null))}}]),t}(s.a.Component);c.a.send("VKWebAppInit"),i.a.render(s.a.createElement(se,null),document.getElementById("root"))}},[[193,1,2]]]);
//# sourceMappingURL=main.98d9ad83.chunk.js.map